<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SYS_USER">

	<!-- 动态查询 and 列表分页 -->
	<sql id="queryDynSql">
		<isNotEmpty prepend="and" property="ID">
			U.ID = #ID#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="USER_NAME">
			U.NAME LIKE '%'||#USER_NAME#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="and" property="USER_STAUS">
			U.USER_STAUS = #USER_STAUS#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="ORG_ID">
			U.OFFICE_ID = #ORG_ID#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="USER_ID">
			U.LOGIN_NAME = #USER_ID#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="USER_TYP">
			U.USER_TYP = #USER_TYP#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="USER_PSW">
			U.PASSWORD = #USER_PSW#
		</isNotEmpty>
		and U.DEL_FLAG = '0'
	</sql>
	<!-- 查询SQL -->
	<sql id="coreSql">
		<![CDATA[SELECT
            U.ID AS ID,
			U.OFFICE_ID AS ORG_ID,
			U.LOGIN_NAME AS USER_ID,
			U.PASSWORD AS USER_PSW,
			U.NAME AS NAME_CN,
			U.EMAIL AS USER_EMAIL,
			U.MOBILE AS USER_TEL,
			U.USER_TYPE AS USER_TYP,
			TO_CHAR(U.LOGIN_DATE, 'yyyy-MM-dd') AS LAST_LGN_DATE,
			TO_CHAR(U.LOGIN_DATE, 'HH24:mm:ss') AS LAST_LGN_TIME,
			U.USER_SEX AS USER_SEX,
			U.RSET_PSW_MARK AS RSET_PSW_MARK,
			U.USE_FIRST_MARK AS USE_FIRST_MARK,
			U.USER_STAUS AS USER_STAUS,
			U.CREATE_DATE AS USER_OPEN_DATE,
			U.USER_END_DATE AS USER_END_DATE,
			U.ERR_LGN_CNT AS ERR_LGN_CNT
			O.NAME 
		FROM ${schema.configPlat}.SYS_USER U
			LEFT JOIN ${schema.configPlat}.SYS_ORGAN O 
				ON O.OFFICE_ID=U.ID]]>
		<dynamic prepend="WHERE">
			<include refid="queryDynSql" />
		</dynamic> 
		<![CDATA[ ORDER BY USER_ID]]>
	</sql>
	<sql id="checkSql">
		<![CDATA[SELECT
                U.ID AS ID,
				U.OFFICE_ID AS ORG_ID,
				U.LOGIN_NAME AS USER_ID,
				U.PASSWORD AS USER_PSW,
				U.NAME AS NAME_CN,
				U.EMAIL AS USER_EMAIL,
				U.MOBILE AS USER_TEL,
				U.USER_TYPE AS USER_TYP,
				TO_CHAR(U.LOGIN_DATE, 'yyyy-MM-dd') AS LAST_LGN_DATE,
				TO_CHAR(U.LOGIN_DATE, 'HH24:mm:ss') AS LAST_LGN_TIME,
				U.USER_SEX AS USER_SEX,
				U.RSET_PSW_MARK AS RSET_PSW_MARK,
				U.USE_FIRST_MARK AS USE_FIRST_MARK,
				U.USER_STAUS AS USER_STAUS,
				U.CREATE_DATE AS USER_OPEN_DATE,
				U.USER_END_DATE AS USER_END_DATE,
				U.ERR_LGN_CNT AS ERR_LGN_CNT
		 FROM ${schema.configPlat}.SYS_USER U]]>
		<dynamic prepend="WHERE">
			<include refid="queryDynSql" />
		</dynamic> 
		<![CDATA[ ORDER BY USER_ID]]>
	</sql>
	<!-- 分页查询 -->
	<select id="pageQuery" parameterClass="map" resultClass="java.util.HashMap">
		<include refid="public.pageBegin" />
		<include refid="coreSql" />
		<include refid="public.pageEnd" />
	</select>
    <!-- 密码校验 -->
    <select id="CheckPwd" parameterClass="map" resultClass="java.util.HashMap">
		<include refid="checkSql" />
	</select>
	<!-- 分页计数 -->
	<select id="pageCount" parameterClass="map" resultClass="int">
		<![CDATA[
			SELECT COUNT('') CNT 
			FROM ${schema.configPlat}.SYS_USER U
		]]>
		<dynamic prepend="WHERE">
			<include refid="queryDynSql" />
		</dynamic>
	</select>


  
	
	<update id="updateById" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<!-- 現在審核ID -->
			<isNotNull prepend="," property="NAME_CN">NAME = #NAME_CN#</isNotNull>
			<isNotNull prepend="," property="USER_SEX">USER_SEX = #USER_SEX#</isNotNull>
			<isNotNull prepend="," property="USER_PSW">PASSWORD = #USER_PSW#</isNotNull>
			<isNotNull prepend="," property="RSET_PSW_MARK">RSET_PSW_MARK = #RSET_PSW_MARK#</isNotNull>
			<isNotNull prepend="," property="USE_FIRST_MARK">USE_FIRST_MARK = #USE_FIRST_MARK#</isNotNull>
			<isNotNull prepend="," property="ORG_ID">OFFICE_ID = #ORG_ID#</isNotNull>
			<isNotNull prepend="," property="USER_STAUS">USER_STAUS = #USER_STAUS#</isNotNull>
			<isNotNull prepend="," property="USER_END_DATE">USER_END_DATE = #USER_END_DATE#</isNotNull>
			<isNotNull prepend="," property="USER_TEL">MOBILE = #USER_TEL#</isNotNull>
			<isNotNull prepend="," property="USER_EMAIL">EMAIL = #USER_EMAIL#</isNotNull>
			<isNotNull prepend="," property="ERR_LGN_CNT">ERR_LGN_CNT = #ERR_LGN_CNT#</isNotNull>
			<isNotNull prepend="," property="USER_TYP">USER_TYP = #USER_TYP#</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #USER_ID# AND DEL_FLAG = '0']]>
	</update>

	<!-- 查询操作 -->
	<select id="query" parameterClass="map" resultClass="java.util.HashMap">
		<include refid="coreSql" />
	</select>
	
	<!-- 加载,只保存用户一种角色信息 -->
	<select id="loadById" parameterClass="String" resultClass="java.util.HashMap">
			<![CDATA[SELECT
                U.ID AS ID,
				U.OFFICE_ID AS ORG_ID,
				U.LOGIN_NAME AS USER_ID,
				U.PASSWORD AS USER_PSW,
				U.NAME AS NAME_CN,
				U.EMAIL AS USER_EMAIL,
				U.MOBILE AS USER_TEL,
				U.USER_TYPE AS USER_TYPE,
				U.USER_TYP AS USER_TYP,
				TO_CHAR(U.LOGIN_DATE, 'yyyy-MM-dd') AS LAST_LGN_DATE,
				TO_CHAR(U.LOGIN_DATE, 'HH24:mm:ss') AS LAST_LGN_TIME,
				U.USER_SEX AS USER_SEX,
				U.RSET_PSW_MARK AS RSET_PSW_MARK,
				U.USE_FIRST_MARK AS USE_FIRST_MARK,
				U.USER_STAUS AS USER_STAUS,
				U.CREATE_DATE AS USER_OPEN_DATE,
				U.USER_END_DATE AS USER_END_DATE,
				U.ERR_LGN_CNT AS ERR_LGN_CNT,
				O.NAME AS ORG_NAME
			FROM ${schema.configPlat}.SYS_USER U  
			LEFT JOIN ${schema.configPlat}.SYS_ORGAN O ON U.OFFICE_ID = O.ID
			WHERE U.LOGIN_NAME = #USER_ID# AND U.DEL_FLAG='0']]>
	</select>  
	
	<!-- 自动更新错误登录次数 -->
	<update id="updateErrLgnCnt" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER u]]>
			<dynamic prepend="set">
				<isEqual prepend="," property="STATUS" compareValue="1">
						<![CDATA[u.ERR_LGN_CNT = 0]]>
				</isEqual>
				<isNotEqual prepend="," property="STATUS" compareValue="1">
					<![CDATA[u.ERR_LGN_CNT = u.ERR_LGN_CNT + 1]]>
				</isNotEqual>
			</dynamic>
		<![CDATA[ where u.LOGIN_NAME = #USER_ID:VARCHAR# AND u.DEL_FLAG = '0' ]]>
	</update>

	<!-- 自动更新错误登录次数 (最新)-->
	<update id="updateErrLoginCnt" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER u]]>
			<dynamic prepend="set">
				<isEqual prepend="," property="STATUS" compareValue="1">
						<![CDATA[u.ERR_LGN_CNT = 0]]>
				</isEqual>
				<isNotEqual prepend="," property="STATUS" compareValue="1">
					<![CDATA[u.ERR_LGN_CNT = #ERR_LGN_CNT#]]>
				</isNotEqual>
			</dynamic>
		<![CDATA[ where u.login_name = #USER_ID:VARCHAR# AND u.DEL_FLAG = '0' ]]>
	</update>
		
	<!-- 更新最近一次登录时间 -->
	<update id="updateLastLgnTime" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER u]]>
			<dynamic prepend="set">
				<isNotNull prepend="," property="LAST_LGN_DATE">
						<![CDATA[u.LOGIN_DATE = sysdate]]>
				</isNotNull>
			</dynamic>
		<![CDATA[ where u.LOGIN_NAME = #USER_ID:VARCHAR# AND u.DEL_FLAG = '0' ]]>
	</update>

	<!-- 更新最近一次登录时间 (最新)-->
	<update id="updateLastLoginTime" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER u]]>
			<dynamic prepend="set">
				<isNotNull prepend="," property="LAST_LGN_DATE">
						<![CDATA[u.LOGIN_DATE = sysdate]]>
				</isNotNull>
			</dynamic>
		<![CDATA[ where u.login_name = #USER_ID:VARCHAR# AND u.DEL_FLAG = '0' ]]>
	</update>
		
	<!-- 更新信息 -->
	<update id="updateUserById" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="NAME_CN">NAME = #NAME_CN#</isNotNull>
			<isNotNull prepend="," property="USER_SEX">USER_SEX = #USER_SEX#</isNotNull>
			<isNotNull prepend="," property="USER_PSW">PASSWORD = #USER_PSW#</isNotNull>
			<isNotNull prepend="," property="RSET_PSW_MARK">RSET_PSW_MARK = #RSET_PSW_MARK#</isNotNull>
			<isNotNull prepend="," property="USE_FIRST_MARK">USE_FIRST_MARK = #USE_FIRST_MARK#</isNotNull>
			<isNotNull prepend="," property="ORG_ID">OFFICE_ID = #ORG_ID#</isNotNull>
			<isNotNull prepend="," property="USER_STAUS">USER_STAUS = #USER_STAUS#</isNotNull>
			<isNotNull prepend="," property="USER_END_DATE">USER_END_DATE = #USER_END_DATE#</isNotNull>
			<isNotNull prepend="," property="USER_TEL">MOBILE = #USER_TEL#</isNotNull>
			<isNotNull prepend="," property="USER_EMAIL">EMAIL = #USER_EMAIL#</isNotNull>
			<isNotNull prepend="," property="ERR_LGN_CNT">ERR_LGN_CNT = #ERR_LGN_CNT#</isNotNull>
			<isNotNull prepend="," property="USER_TYP">USER_TYP = #USER_TYP#</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #USER_ID:VARCHAR# AND u.DEL_FLAG = '0' ]]>
	</update>
	
	<select id="queryOrg" parameterClass="map" resultClass="java.util.HashMap">
	<![CDATA[
		SELECT O.NAME ,O.ID AS ORG_ID FROM ${schema.configPlat}.SYS_USER U
		LEFT JOIN
		${schema.configPlat}.SYS_ORGAN O ON O.ID=U.OFFICE_ID
		WHERE O.GRADE='3' AND U.LOGIN_NAME=#USER_ID# AND U.DEL_FLAG = '0'
		]]>
	</select>
	<select id="queryOrgid" parameterClass="map" resultClass="java.util.HashMap">
	<![CDATA[
	    SELECT O.NAME ,o.ID FROM ${schema.configPlat}.SYS_USER U
		LEFT JOIN
		${schema.configPlat}.SYS_ORGAN O ON O.ID=U.OFFICE_ID
		WHERE LOGIN_NAME=#USER_ID# AND U.DEL_FLAG = '0'
		]]>
	</select>
	
	<!-- 客户端用户密码修改 -->
	<update id="updatePassWordByUserId" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="USER_PSW">PASSWORD = #USER_PSW#</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #USER_ID# AND DEL_FLAG = '0']]>
	</update>

	<!-- 根据角色与机构查询用户 -->
	<select id="queryByRoleAndOffice" parameterClass="map" resultClass="java.util.HashMap">
		<![CDATA[
			SELECT U.ID AS USER_ID, U.LOGIN_NAME, U.NAME AS USER_NAME FROM ${schema.configPlat}.SYS_USER U
				WHERE U.ID IN (
					SELECT DISTINCT UR.USER_ID FROM ${schema.configPlat}.SYS_USER_ROLE UR WHERE UR.ROLE_ID = #ROLE_ID#
				) AND U.OFFICE_ID = #OFFICE_ID# AND U.DEL_FLAG = '0'
		]]>
	</select>

	<!-- 更新用户登录 logintoken 属性 -->
	<update id="updateLoginTokenByUserId" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="LOGINTOKEN">LOGINTOKEN = #LOGINTOKEN#</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #USER_ID# AND DEL_FLAG = '0']]>
	</update>
<!-- 根据parentId去查询parent_ids -->
	<select id="getIdsByParentId" parameterClass="map" resultClass="java.util.HashMap">
			<![CDATA[SELECT U.ID, U.PARENT_IDS,U.DEL_FLAG
			FROM ${schema.configPlat}.SYS_ORGAN U  
			WHERE U.ID = #PARENT_ID# ]]>
	</select>
	<!-- 接口同步新增用户数据 -->
    <insert id="insertOrg" parameterClass="map">
		<![CDATA[
			INSERT INTO ${schema.configPlat}.SYS_ORGAN
				(
				ID,
				PARENT_ID,
				NAME, 
				AREA_ID,
				PARENT_IDS,
				GRADE,
				CODE,
				DEL_FLAG,
				REMARKS,
				ORG_VALID,
				QYNGRQ,
				XNJGBZ,
				CREATE_DATE,
				UPDATE_DATE
				)
			VALUES 
				(   
				    #ID#,
					#PARENT_ID#,
					#NAME#,
					#AREA_ID#,
					#PARENT_IDS#,
					#GRADE#,
					#CODE#,
					#DEL_FLAG#,
					#REMARKS#,
					#ORG_VALID#,
					#QYNGRQ#,
					#XNJGBZ#,
					sysdate,
					sysdate
				)

		]]>
	</insert>
	<!-- 根据id去查询delFlag -->
	<select id="getDelFlag1" parameterClass="map" resultClass="java.util.HashMap">
			<![CDATA[SELECT U.ID, U.DEL_FLAG
			FROM ${schema.configPlat}.SYS_ORGAN U  
			WHERE U.ID = #ID# ]]>
	</select> 
	<!-- 接口同步修改组织结构 数据 -->
	<update id="updateOrg" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_ORGAN ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="NAME">NAME = #NAME#</isNotNull>
			<isNotNull prepend="," property="PARENT_ID">PARENT_ID = #PARENT_ID#</isNotNull>
			<isNotNull prepend="," property="PARENT_IDS">PARENT_IDS = #PARENT_IDS#</isNotNull>
			<isNotNull prepend="," property="GRADE">GRADE = #GRADE#</isNotNull>
			<isNotNull prepend="," property="DEL_FLAG">DEL_FLAG = #DEL_FLAG#</isNotNull>
			<isNotNull prepend="," property="CODE">CODE = #CODE#</isNotNull>
			<isNotNull prepend="," property="REMARKS">REMARKS = #REMARKS#</isNotNull>
			<isNotNull prepend="," property="ORG_VALID">ORG_VALID = #ORG_VALID#</isNotNull>
			<isNotNull prepend="," property="QYNGRQ">QYNGRQ = #QYNGRQ#</isNotNull>
			<isNotNull prepend="," property="XNJGBZ">XNJGBZ = #XNJGBZ#</isNotNull>
			<isNotNull prepend="," property="UPDATE_DATE">
				<![CDATA[UPDATE_DATE = sysdate]]>
			</isNotNull>
		</dynamic>
		<![CDATA[ where ID = #ID# AND DEL_FLAG =  #REV_DEL_FLAG#]]>
	</update>
	<!-- 接口同步删除组织结构 -->
	<update id="deletedOrg" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_ORGAN ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="DEL_FLAG">DEL_FLAG = #DEL_FLAG#</isNotNull>
			<isNotNull prepend="," property="UPDATE_DATE">
				<![CDATA[UPDATE_DATE = sysdate]]>
			</isNotNull>
		</dynamic>
		<![CDATA[ where ID = #ID# AND DEL_FLAG = '0']]>
	</update>
	<!-- 接口同步新增用户数据 -->
    <insert id="insertUser1" parameterClass="map">
		<![CDATA[
			INSERT INTO ${schema.configPlat}.SYS_USER
				(	ID, 
					COMPANY_ID, 
					OFFICE_ID, 
					LOGIN_NAME, 
					PASSWORD, 
					NO, 
					NAME, 
					EMAIL, 
					PHONE, 
					MOBILE, 
					USER_TYPE, 
					LOGIN_IP, 
					LOGIN_DATE, 
					CREATE_BY, 
					CREATE_DATE, 
					UPDATE_BY, 
					UPDATE_DATE, 
					REMARKS, 
					DEL_FLAG, 
					DEVICE_MODEL, 
					DEVICE_SYSTEM, 
					USER_SEX, 
					RSET_PSW_MARK, 
					USE_FIRST_MARK, 
					USER_STAUS, 
					USER_END_DATE, 
					ERR_LGN_CNT, 
					USER_TYP, 
					HEAD_IMG, 
					LOGINTOKEN, 
					CLIENT_ID, 
					APPTYPE, 
					FINGERPRINT_ID 
			VALUES 
				(   
				    #ID#, 
					#COMPANY_ID#, 
					#OFFICE_ID#, 
					#LOGIN_NAME#, 
					#PASSWORD#, 
					#NO#, 
					#NAME#, 
					#EMAIL#, 
					#PHONE#, 
					#MOBILE#, 
					#USER_TYPE#, 
					#LOGIN_IP#, 
					#LOGIN_DATE#, 
					#CREATE_BY#, 
					#CREATE_DATE#, 
					#UPDATE_BY#, 
					#UPDATE_DATE#, 
					#REMARKS#, 
					#DEL_FLAG#, 
					#DEVICE_MODEL#, 
					#DEVICE_SYSTEM#, 
					#USER_SEX#, 
					#RSET_PSW_MARK#, 
					#USE_FIRST_MARK#, 
					#USER_STAUS#, 
					#USER_END_DATE#, 
					#ERR_LGN_CNT#, 
					#USER_TYP#, 
					#HEAD_IMG#, 
					#LOGINTOKEN#, 
					#CLIENT_ID#, 
					#APPTYPE#, 
					#FINGERPRINT_ID# 
				)

		]]>
	</insert>
	<!-- 接口同步新增用户数据 -->
    <insert id="insertUser" parameterClass="map">
		<![CDATA[
			INSERT INTO ${schema.configPlat}.SYS_USER
				(
				ID,
				MOBILE, 
				COMPANY_ID,
				OFFICE_ID,
				LOGIN_NAME,
				PASSWORD,
				DEL_FLAG,
				NAME,
				NO,
				USER_TYPE,
				USER_SEX,
				USE_FIRST_MARK,
				USER_STAUS,
				CREATE_DATE,
				UPDATE_DATE,
				RSET_PSW_MARK,
				PHONE,
				EMAIL
				)
			VALUES 
				(   
				    #LOGIN_NAME#,
					#MOBILE#,
					#COMPANY_ID#,
					#OFFICE_ID#,
					#LOGIN_NAME#,
					#PASSWORD#,
					#DEL_FLAG#,
					#NAME#,
					#NO#,
					#USER_TYPE#,
					#USER_SEX#,
					#USE_FIRST_MARK#,
					#USER_STAUS#,
					sysdate,
					sysdate,
					#RSET_PSW_MARK#,
					#PHONE#,
					#EMAIL#
				)

		]]>
	</insert>
	<!-- 根据loginName去查询delFlag -->
	<select id="getDelFlag" parameterClass="map" resultClass="java.util.HashMap">
			<![CDATA[SELECT U.ID, U.DEL_FLAG
			FROM ${schema.configPlat}.SYS_USER U  
			WHERE U.LOGIN_NAME = #LOGIN_NAME# ]]>
	</select> 
	<!-- 接口同步删除用户数据 -->
	<update id="deletedUser" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="DEL_FLAG">DEL_FLAG = #DEL_FLAG#</isNotNull>
			<isNotNull prepend="," property="STATUS">STATUS = #STATUS#</isNotNull>
			<isNotNull prepend="," property="UPDATE_DATE">
				<![CDATA[UPDATE_DATE = sysdate]]>
			</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #LOGIN_NAME# AND DEL_FLAG = '0']]>
	</update>
	<!-- 接口同步修改用户数据 -->
	<update id="updateUser" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="MOBILE">MOBILE = #MOBILE#</isNotNull>
			<isNotNull prepend="," property="OFFICE_ID">OFFICE_ID = #OFFICE_ID#</isNotNull>
			<isNotNull prepend="," property="NAME">NAME = #NAME#</isNotNull>
			<isNotNull prepend="," property="DEL_FLAG">DEL_FLAG = #DEL_FLAG#</isNotNull>
			<isNotNull prepend="," property="PASSWORD">PASSWORD = #PASSWORD#</isNotNull>
			<isNotNull prepend="," property="NO">NO = #NO#</isNotNull>
			<isNotNull prepend="," property="USER_TYPE">USER_TYPE = #USER_TYPE#</isNotNull>
			<isNotNull prepend="," property="COMPANY_ID">COMPANY_ID = #COMPANY_ID#</isNotNull>
			<isNotNull prepend="," property="USER_SEX">USER_SEX = #USER_SEX#</isNotNull>
			<isNotNull prepend="," property="PHONE">PHONE = #PHONE#</isNotNull>
			<isNotNull prepend="," property="EMAIL">EMAIL = #EMAIL#</isNotNull>
			<isNotNull prepend="," property="RSET_PSW_MARK">RSET_PSW_MARK = #RSET_PSW_MARK#</isNotNull>
			<isNotNull prepend="," property="USE_FIRST_MARK">USE_FIRST_MARK = #USE_FIRST_MARK#</isNotNull>
			<isNotNull prepend="," property="USER_STAUS">USER_STAUS = #USER_STAUS#</isNotNull>
			<isNotNull prepend="," property="UPDATE_DATE">
				<![CDATA[UPDATE_DATE = sysdate]]>
			</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #LOGIN_NAME#]]>
	</update>
	
	
	<!-- 设置手势密码 -->
	<update id="updateGstInfo" parameterClass="map">
		<![CDATA[ update ${schema.configPlat}.SYS_USER ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="GUESTER_PWD">GUESTER_PWD = #GUESTER_PWD#</isNotNull>
			<isNotNull prepend="," property="GUESTER_FLAG">GUESTER_FLAG = #GUESTER_FLAG#</isNotNull>
		</dynamic>
		<![CDATA[ where LOGIN_NAME = #USER_ID#]]>
	</update>
	
		<!-- 根据loginName去查询delFlag -->
	<select id="queryGstInfo" parameterClass="map" resultClass="java.util.HashMap">
			<![CDATA[SELECT U.GUESTER_PWD,U.GUESTER_FLAG FROM ${schema.configPlat}.SYS_USER U  WHERE U.LOGIN_NAME = #USER_ID# ]]>
	</select> 
</sqlMap>

