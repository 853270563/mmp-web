<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="DEVICE_LOG">

    <sql id="queryDynSql">
        <isNotEmpty prepend="AND" property="LOG_ID">
            T.LOG_ID = #LOG_ID#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="DEVICE_ID">
            T.DEVICE_ID = #DEVICE_ID#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="APP_ID">
            T.APP_ID = #APP_ID#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="USER_ID">
            T.USER_ID = #USER_ID#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="IP_ADDR">
            T.IP_ADDR = #IP_ADDR#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="GPS">
            T.GPS = #GPS#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="LOG_TIME">
            T.LOG_TIME = #LOG_TIME#
        </isNotEmpty>
    </sql>

    <!-- 查询SQL -->
    <sql id="coreSql">
        SELECT T.* FROM ${schema.interPlat}.DEVICE_LOG T
        <dynamic prepend="WHERE">
            <include refid="queryDynSql"/>
        </dynamic>
        <![CDATA[ ORDER BY T.LOG_ID]]>
    </sql>
    <!-- 分页查询 -->
    <select id="pageQuery" parameterClass="map" resultClass="java.util.HashMap">
        <include refid="public.pageBegin"/>
        <include refid="coreSql"/>
        <include refid="public.pageEnd"/>
    </select>
    <!-- 分页计数 -->
    <select id="pageCount" parameterClass="map" resultClass="int">
        <![CDATA[
			SELECT COUNT('') CNT
			FROM ${schema.interPlat}.DEVICE_LOG T
		]]>
        <dynamic prepend="WHERE">
            <include refid="queryDynSql"/>
        </dynamic>
    </select>

    <!-- 增加、修改时将信息存放到op表中 -->
    <insert id="insert" parameterClass="map">
        INSERT INTO ${schema.interPlat}.DEVICE_LOG
        (
        LOG_ID
        <isNotEmpty prepend="," property="DEVICE_ID">DEVICE_ID</isNotEmpty>
        <isNotEmpty prepend="," property="APP_ID">APP_ID</isNotEmpty>
        <isNotEmpty prepend="," property="USER_ID">USER_ID</isNotEmpty>
        <isNotEmpty prepend="," property="IP_ADDR">IP_ADDR</isNotEmpty>
        <isNotEmpty prepend="," property="GPS">GPS</isNotEmpty>
        <isNotEmpty prepend="," property="LOG_TIME">LOG_TIME</isNotEmpty>
        ) VALUES (
        #LOG_ID#
        <isNotEmpty prepend="," property="DEVICE_ID">#DEVICE_ID#</isNotEmpty>
        <isNotEmpty prepend="," property="APP_ID">#APP_ID#</isNotEmpty>
        <isNotEmpty prepend="," property="USER_ID">#USER_ID#</isNotEmpty>
        <isNotEmpty prepend="," property="IP_ADDR">#IP_ADDR#</isNotEmpty>
        <isNotEmpty prepend="," property="GPS">#GPS#</isNotEmpty>
        <isNotEmpty prepend="," property="LOG_TIME">#LOG_TIME#</isNotEmpty>
        )
    </insert>

    <update id="updateById" parameterClass="map">
        <![CDATA[ update ${schema.interPlat}.DEVICE_LOG ]]>
        <dynamic prepend="set">
            <isNotNull prepend="," property="DEVICE_ID">DEVICE_ID = #DEVICE_ID#</isNotNull>
            <isNotNull prepend="," property="APP_ID">APP_ID = #APP_ID#</isNotNull>
            <isNotNull prepend="," property="USER_ID">USER_ID = #USER_ID#</isNotNull>
            <isNotNull prepend="," property="IP_ADDR">IP_ADDR = #IP_ADDR#</isNotNull>
            <isNotNull prepend="," property="GPS">GPS = #GPS#</isNotNull>
            <isNotNull prepend="," property="LOG_TIME">LOG_TIME = #LOG_TIME#</isNotNull>
        </dynamic>
        <![CDATA[ where LOG_ID = #LOG_ID# ]]>
    </update>

    <delete id="delete" parameterClass="map">
        <![CDATA[
         delete from ${schema.interPlat}.DEVICE_LOG where DEVICE_ID = #DEVICE_ID#
        ]]>
    </delete>

    <select id="query" parameterClass="map" resultClass="java.util.HashMap">
        <include refid="coreSql"/>
    </select>

    <select id="seq" resultClass="String">
        select ${schema.interPlat}.SEQ_DEVICE_LOG.nextval from dual
    </select>

</sqlMap>

